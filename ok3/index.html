<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SustainGraph â€” Scientific Sustainable Fashion Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="style.css" />

    <!-- Libs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0/dist/tf.min.js"></script>
  </head>

  <body>
    <div id="app-root">
      <header class="app-header">
        <div class="brand-block">
          <h1>SustainGraph</h1>
          <p>
            Scientific AI-powered sustainable fashion recommendation dashboard with
            Entropy Weight Method (data-driven weighting), K-Means Clustering (Elbow validated),
            Multi-Objective Optimization (Pareto Frontier), and optional MLP Predictor for missing attributes.
          </p>
        </div>
      </header>

      <main class="app-main">
        <!-- LEFT PANEL -->
        <section class="panel panel-left">
          <!-- Upload -->
          <section class="card">
            <h2>1. Upload CSV Dataset</h2>
            <p class="subnote">Use your Kaggle dataset or auto-load from repo.</p>

            <div class="upload-row">
              <div>
                <label class="field-label">Choose file</label>
                <input type="file" id="fileUpload" accept=".csv" />
                <button id="load-sample" class="btn secondary-btn">
                  Load Local CSV
                </button>
              </div>

              <div>
                <label class="field-label">Auto-load from GitHub</label>
                <button id="auto-upload" class="btn primary-btn">
                  Auto Upload
                </button>
              </div>
            </div>

            <div id="load-status" class="status-chip"></div>
          </section>

          <!-- Filters -->
          <section class="card">
            <h2>2. Filters & Sustainability Priority</h2>

            <div class="filters-grid">
              <div class="field">
                <label class="field-label">Country</label>
                <select id="country-filter"></select>
              </div>

              <div class="field">
                <label class="field-label">Material</label>
                <select id="material-filter"></select>
              </div>

              <div class="field">
                <label class="field-label">Year</label>
                <select id="year-filter"></select>
              </div>

              <div class="field">
                <label class="field-label">Certification</label>
                <select id="cert-filter"></select>
              </div>

              <div class="field">
                <label class="field-label">Market Trend</label>
                <select id="trend-filter"></select>
              </div>
            </div>

            <div class="priority-row">
              <button id="run-pipeline" class="btn run-btn full-width-btn">
                ðŸš€ Run Analysis
              </button>
            </div>
          </section>

          <!-- KPIs -->
          <section class="card">
            <h2>3. Key Sustainability Indicators</h2>
            <div id="kpi-row" class="kpi-row"></div>
          </section>

          <!-- Data Quality Validation (NEW) -->
          <section class="card">
            <h2>4. Data Quality Validation</h2>
            <p class="subnote">Statistical validation of environmental indicators variance and entropy weighting rationale.</p>
            <div id="data-quality-validation" class="validation-content"></div>
          </section>
        </section>

        <!-- RIGHT PANEL -->
        <section class="panel panel-right">
          <!-- EDA -->
          <section class="card">
            <h2>5. Exploratory Data Insights</h2>

            <div class="eda-grid">
              <div class="eda-chart">
                <div class="eda-chart-left">
                  <h3 class="eda-title">Material â€” Price & SIS</h3>
                  <div id="eda-material" class="plot small-plot"></div>
                </div>
                <div id="eda-material-insight" class="eda-insight"></div>
              </div>

              <div class="eda-chart">
                <div class="eda-chart-left">
                  <h3 class="eda-title">Country â€” Price & SIS</h3>
                  <div id="eda-country" class="plot small-plot"></div>
                </div>
                <div id="eda-country-insight" class="eda-insight"></div>
              </div>

              <div class="eda-chart">
                <div class="eda-chart-left">
                  <h3 class="eda-title">Market Trend â€” Count & SIS</h3>
                  <div id="eda-trend" class="plot small-plot"></div>
                </div>
                <div id="eda-trend-insight" class="eda-insight"></div>
              </div>

              <div class="eda-chart">
                <div class="eda-chart-left">
                  <h3 class="eda-title">Year â€” Price & SIS</h3>
                  <div id="eda-year" class="plot small-plot"></div>
                </div>
                <div id="eda-year-insight" class="eda-insight"></div>
              </div>
            </div>
          </section>

          <!-- Clustering Validation (Elbow + Scatter) -->
          <section class="card">
            <h2>6. K-Means Clustering Validation & Visualization</h2>
            <p class="subnote">
              Determining optimal k (Elbow Method) and visualizing material clusters with detailed interpretation.
            </p>

            <div class="clustering-chart full-width-chart">
              <h3 class="eda-title">Elbow Method â€” Optimal k</h3>
              <div id="elbow-chart" class="plot full-width-plot"></div>
              <div id="elbow-insight" class="eda-insight"></div>
            </div>

            <div class="clustering-chart full-width-chart">
              <h3 class="eda-title">Material Clusters (k=Optimal)</h3>
              <div id="cluster-scatter" class="plot full-width-plot"></div>
              <div id="cluster-legend" class="cluster-legend"></div>
              <div id="cluster-scatter-insight" class="eda-insight"></div>
            </div>

            <!-- NEW: Cluster Interpretation Table -->
            <div class="clustering-chart full-width-chart">
              <h3 class="eda-title">Cluster Interpretation & Statistics</h3>
              <div id="cluster-interpretation-table" class="cluster-table"></div>
            </div>
          </section>

          <!-- Pareto Frontier -->
          <section class="card">
            <h2>7. Multi-Objective Optimization (Pareto Frontier)</h2>

            <p class="subnote">
              Optimal Priceâ€“SIS trade-off using MOO (Materials + Brands)
            </p>

            <h3>Material Pareto Frontier</h3>
            <div id="pareto-material" class="plot small-plot"></div>

            <h3>Brand Pareto Frontier</h3>
            <div id="pareto-brand" class="plot small-plot"></div>
            <div id="pareto-insight" class="eda-insight"></div>
          </section>

          <!-- Recommendations (UPDATED) -->
          <section class="card">
            <h2>8. Multi-Objective Brand Recommendations</h2>
            <p class="subnote">
              Three recommendation categories based on Pareto-optimality: Max Sustainability, Best Value, and Balanced Trade-off.
            </p>
            
            <div class="recommendations-tabs">
              <button class="tab-btn active" data-tab="max-sustainability">Max Sustainability</button>
              <button class="tab-btn" data-tab="best-value">Best Value</button>
              <button class="tab-btn" data-tab="balanced">Balanced Trade-off</button>
            </div>

            <div class="recommendations-content">
              <div id="reco-max-sustainability" class="reco-tab-content active">
                <p class="tab-description">Top Pareto-optimal brands with highest SIS scores.</p>
                <div class="reco-list"></div>
              </div>
              <div id="reco-best-value" class="reco-tab-content">
                <p class="tab-description">Pareto-optimal brands with lowest prices (not dominated).</p>
                <div class="reco-list"></div>
              </div>
              <div id="reco-balanced" class="reco-tab-content">
                <p class="tab-description">Pareto-optimal brands near the center of the trade-off curve.</p>
                <div class="reco-list"></div>
              </div>
            </div>
          </section>

          <!-- Prediction (NEW - Optional) -->
          <section class="card">
            <h2>9. Sustainability Attribute Prediction (Optional ML Extension)</h2>
            <p class="subnote">
              MLP-based predictor for missing sustainability ratings or policy indicators. Trained on client-side using TensorFlow.js.
            </p>
            
            <div class="prediction-section">
              <div class="prediction-status" id="prediction-status">
                Model not trained yet. Click "Train Model" to begin.
              </div>
              
              <button id="train-model-btn" class="btn primary-btn">Train Prediction Model</button>
              
              <div class="prediction-form" id="prediction-form" style="display: none;">
                <h3>Predict Sustainability Rating</h3>
                <div class="prediction-inputs">
                  <div class="field">
                    <label class="field-label">Carbon Footprint (MT)</label>
                    <input type="number" id="pred-carbon" step="0.1" placeholder="e.g., 2.5" />
                  </div>
                  <div class="field">
                    <label class="field-label">Water Usage (Liters)</label>
                    <input type="number" id="pred-water" step="1" placeholder="e.g., 5000" />
                  </div>
                  <div class="field">
                    <label class="field-label">Waste Production (KG)</label>
                    <input type="number" id="pred-waste" step="0.1" placeholder="e.g., 15" />
                  </div>
                  <div class="field">
                    <label class="field-label">Recycling Program</label>
                    <select id="pred-recycling">
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                </div>
                <button id="predict-btn" class="btn run-btn">Predict Rating</button>
                <div id="prediction-result" class="prediction-result"></div>
              </div>
            </div>
          </section>
        </section>
      </main>

      <footer class="app-footer">
        <span>
          <strong>Scientific Methodology:</strong> Entropy Weight Method (Zhao et al., 2021) for data-driven weighting, 
          K-Means with Elbow validation, Multi-Objective Optimization (Ghasemy et al., 2025) with Pareto Frontier analysis, 
          and optional MLP predictor for missing attributes. 
          Dataset: Sustainable Fashion & Eco-friendly Trends (Kaggle). Deployed on GitHub Pages â€” 100% Client-side.
        </span>
      </footer>
    </div>

    <script src="app.js"></script>
    <script src="script.js"></script>
  </body>
</html>

